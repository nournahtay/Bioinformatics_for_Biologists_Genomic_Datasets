install.packages("tidyr")
install.packages("dplyr")
install.packages("tidyverse")
list.files()
var <- read.csv("variants_long_table.csv")
head(var)
dim(var)
nrow(var)
ncol(var)
str(var)
summary(var)
summary(var$SAMPLE)
summary(var$DP)
class(var)
class(var$CHROM)
typeof(var$CHROM)
View(var)
colnames(var)
var[, c(1, 4, 5)]
select(var, SAMPLE, REF, ALT)
select(var, SAMPLE, REF, ALT) %>% head(3)
select(var, -CALLER) %>% head(3)
> var_tb <- as_tibble(var)
var_tb <- as_tibble(var)
select(var_tb, SAMPLE, REF, ALT) %>% head(3)
var_tb[var_tb$SAMPLE == "SRR13500958",]
filter(var_tb, SAMPLE == "SRR13500958") %>% head(3)
var_tb %>% filter(SAMPLE == "SRR13500958") %>% select(CHROM, POS, REF, ALT) %>% head(3)
var_tb %>% filter(SAMPLE == "SRR13500958") %>% select(CHROM, POS, REF, ALT, DP)
var_tb %>% filter(SAMPLE == "SRR13500958" & DP>=500) %>% select(CHROM, POS, REF, ALT, DP)
var_tb %>% filter(SAMPLE == "SRR13500958" & DP>=1000) %>% select(CHROM, POS, REF, ALT, DP)
var_tb %>% count(SAMPLE)
var_tb %>% count(SAMPLE, sort = TRUE)
var_tb %>% count(SAMPLE, GENE, sort = TRUE) %>% head()
max(var_tb$DP)
min(var_tb$DP)
mean(var_tb$DP)
var_tb_log <- var_tb %>% mutate(DP_log2 = log2(DP))
head(var_tb_log)
select(var_tb_log, SAMPLE, REF, ALT, DP, DP_log2) %>% head()
var_tb %>% group_by(SAMPLE) %>% summarize(max(DP))
var_tb %>% group_by(SAMPLE) %>% summarize(min(DP))
var_tb %>% count(SAMPLE, GENE, sort = TRUE) %>% head(6)
var_tb %>% count(CHROM, sort = TRUE) %>% head()
var_tb %>% count(CHROM, sort = TRUE) %>% head(6)
var_tb %>% count(SAMPLE, CHROM, sort = TRUE) %>% head()
ggplot(data = var_tb)
ggplot(data = var_tb, aes(x=SAMPLE, y=DP))
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_point()
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_boxplot()
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_point() + ylim(0,10000)
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_boxplot() + ylim(0,10000)
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_point() + scale_y_continuous(name="dp", limits=c(0, 10000))
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_boxplot() + scale_y_continuous(name="dp", limits=c(0, 10000))
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_point() + scale_y_continuous(trans='log10')
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_point() + scale_y_log10()
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) + geom_boxplot() + scale_y_log10()
ggplot(data = var_tb, aes(x=SAMPLE, y=DP, colour = SAMPLE)) + geom_boxplot() + ylim(0,10000)
ggplot(data = var_tb, aes(x=SAMPLE, y=DP, fill= SAMPLE)) + geom_boxplot() + ylim(0,10000)
install.packages("RColorBrewer")
ggplot(data = var_tb, aes(x=SAMPLE, y=DP, fill= SAMPLE)) + geom_boxplot() + ylim(0,10000) + scale_fill_manual(values=c("#cb6015", "#e1ad01", "#6d0016", "#808000", "#4e3524"))
ggplot(data = var_tb, aes(x=SAMPLE, y=DP, fill= SAMPLE)) + geom_boxplot() + ylim(0,10000) + scale_fill_brewer(palette="Greens")
display.brewer.all()
ggplot(data = var_tb, aes(x=SAMPLE, y=DP, fill= SAMPLE)) + geom_boxplot() + ylim(0,10000) + scale_fill_brewer(palette="RdYlBu") + theme(legend.position="none")
ggplot(data = var_tb, aes(x=SAMPLE, y=DP, fill= SAMPLE)) + geom_boxplot() + ylim(0,10000) + scale_fill_brewer(palette="RdYlBu") + theme(legend.position="bottom") + labs(title="DP_per_Sample", x="SampleID", y = "DP")
ggplot(data = var_tb, aes(x=SAMPLE, y=DP, fill= SAMPLE)) + geom_boxplot() + ylim(0,10000) + scale_fill_brewer(palette="RdYlBu") + theme(legend.position="bottom") + ggtitle("DP per Sample") + xlab("Sample") + ylab("DP")
ggplot(data = var_tb, aes(x=SAMPLE, y=DP)) +  geom_point(shape = 8, fill = "#e4dbc1", color = "#b92e17", size = 6) + ylim(0,10000)
ggpubr::show_point_shapes()
install.packages("ggpubr")
View(var_tb)
ggplot(data = var_tb, aes(x=CHROM, y=DP, fill= SAMPLE)) + geom_boxplot() + ylim(0,10000) + scale_fill_brewer(palette="RdYlBu") + labs(title="DP_per_Chromosome") + facet_grid(. ~ SAMPLE)
p_DP_CHROM <- ggplot(data = var_tb, aes(x=CHROM, y=DP, fill= SAMPLE)) + ylim(0,10000) + scale_fill_brewer(palette="RdYlBu") + labs(title="DP_per_Chromosome") + theme(legend.position="bottom")
p_DP_CHROM + geom_boxplot() + facet_grid(. ~ SAMPLE)
p_DP_CHROM + geom_violin(trim=FALSE) + facet_grid(. ~ SAMPLE) + geom_boxplot(width=0.1)
p_EFFECT <- ggplot(data = var_tb, aes(x=EFFECT, fill= SAMPLE)) + scale_fill_brewer(palette="RdBu") + labs(title="Effect_per_Sample") + theme(legend.position="bottom")
p_EFFECT + geom_bar()
p_EFFECT_flip <- ggplot(data = var_tb, aes(y=EFFECT, fill= SAMPLE)) + scale_fill_brewer(palette="RdBu") + labs(title="Effect_per_Sample") + theme(legend.position="bottom")
p_EFFECT_flip + geom_bar()
var_tb %>% count(EFFECT)
var_tb %>% count(EFFECT, SAMPLE, sort = TRUE)
var_tb %>% count(EFFECT, GENE, sort = TRUE)
filter(var_tb, EFFECT == "stop_lost" | EFFECT == "stop_gained")
filter(var_tb, EFFECT %in% c("stop_lost", "stop_gained")) %>% select(SAMPLE, CHROM, GENE, EFFECT)
filter(var_tb, EFFECT %in% c("stop_lost", "stop_gained")) %>% select(SAMPLE, CHROM, GENE, EFFECT)
p_DP_POS <- ggplot(data = var_tb, aes(x=POS, y=DP, fill= SAMPLE)) + scale_fill_brewer(palette="RdBu") + labs(title="DP_per_Position") + theme(legend.position="bottom")
p_DP_POS + geom_point(shape = 21, size = 5, alpha = 0.7)
p_DP_POS + geom_boxplot(shape = 21, size = 5)
ggplot(data = var_tb, aes(x=DP, y=ALT_DP)) + geom_point()
ggplot(data = var_tb, aes(x = ALT_DP, y = DP, fill = SAMPLE))+ geom_point(shape = 21, size = 5) + scale_fill_brewer(palette="RdBu")
ggplot(data = var_tb, aes(x = ALT_DP, y = DP, fill = SAMPLE))+ geom_point(shape = 21, size = 5) + scale_fill_brewer(palette="RdBu")
test <- ggplot(data = var_tb, aes(x = ALT_DP, y = DP, fill = SAMPLE)) + geom_point(shape = 21, size = 5) + scale_fill_brewer(palette="RdBu")
test + labs(title="DP_per_ALT_DP") + theme(legend.position="bottom")
